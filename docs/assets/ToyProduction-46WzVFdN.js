import{d as Te,j as y,r as u,p as Me,k as Oe,i as j,w as o,l as x,f as i,o as L,b as d,e as t,g as h,S as Pe,R as Ve,m as Re,t as De,n as Ne,h as qe,_ as Be}from"./index-DxvlNLqH.js";import{l as H,t as Fe,C as $e,d as ze}from"./vuedraggable.umd-Dpm0IBux.js";import{F as Ae}from"./FirmwareReleaseModal-uFBtUBFr.js";import{F as Ue}from"./FirmwareEditModal-CH5Aq32n.js";import{_ as Ee}from"./ProductCreateModal.vue_vue_type_script_setup_true_lang-D48Uvivd.js";import{S as Ke}from"./SettingOutlined-B1YVnB9v.js";import"./InboxOutlined-0UiQZOBg.js";const je={class:"top-controls-wrapper"},Le={class:"left-aligned-section"},He={class:"select-container product-name-select",style:{"margin-left":"10px"}},Je={class:"select-container manufacturer-select",style:{"margin-left":"10px"}},Qe={class:"right-aligned-icons"},We={class:"column-setting-panel",style:{"max-height":"300px","overflow-y":"auto"}},Ze={class:"setting-section"},Ge={class:"section-header",style:{display:"flex","justify-content":"space-between"}},Xe={class:"column-checkbox-item",style:{padding:"4px 0"}},Ye={class:"table-container"},el=["onClick"],ll=Te({__name:"ToyProduction",setup(tl,{expose:J}){const Q=y(()=>({...H,Pagination:{...H.Pagination,page:""}})),v=[{key:"rowIndex",title:"序号",dataIndex:"rowIndex",width:60,fixed:"left",customRender:({index:l})=>l+1},{key:"productId",title:"产品ID",dataIndex:"productId",width:120},{key:"productName",title:"产品名称",dataIndex:"productName",width:180},{key:"productionBatch",title:"生产批次",dataIndex:"productionBatch",width:120,sorter:(l,e)=>l.productionBatch.localeCompare(e.productionBatch),sortDirections:["ascend","descend"]},{key:"manufacturer",title:"生产厂家",dataIndex:"manufacturer",width:200},{key:"unitPrice",title:"单价(元)",dataIndex:"unitPrice",width:100,sorter:(l,e)=>l.unitPrice-e.unitPrice,sortDirections:["ascend","descend"]},{key:"quantity",title:"数量(个)",dataIndex:"quantity",width:100},{key:"totalPrice",title:"总价(元)",dataIndex:"totalPrice",width:120,sorter:(l,e)=>parseFloat(l.totalPrice.replace(/,/g,""))-parseFloat(e.totalPrice.replace(/,/g,"")),sortDirections:["ascend","descend"]},{key:"creator",title:"创建人",dataIndex:"creator",width:80},{key:"createTime",title:"创建时间",dataIndex:"createTime",width:160,sorter:(l,e)=>l.createTime.localeCompare(e.createTime),sortDirections:["ascend","descend"]},{key:"updateTime",title:"更新时间",dataIndex:"updateTime",width:160,sorter:(l,e)=>l.updateTime.localeCompare(e.updateTime),sortDirections:["ascend","descend"]},{key:"operation",title:"操作",dataIndex:"",width:100,fixed:"right"}],k=u(v.map(l=>l.key)),f=u(v.map(l=>l.key)),W=l=>l.map(e=>({title:e.title,dataIndex:e.dataIndex,key:e.key,width:e.width,fixed:e.fixed,sorter:e.sorter,sortDirections:e.sortDirections,sortOrder:_.value&&e.key===_.value.columnKey?_.value.order:void 0,defaultSortOrder:e.defaultSortOrder,customRender:e.customRender?e.customRender:({text:a})=>a==null||a===""?"-":a})),Z=y(()=>{const l=k.value.filter(a=>f.value.includes(a)).map(a=>v.find(s=>s.key===a)).filter(Boolean);return W(l).sort((a,s)=>{const r={left:1,undefined:2,right:3},c=r[a.fixed]||2,C=r[s.fixed]||2;return c-C})}),b=[];for(let l=0;l<12;l++)b.push({key:l+1,productId:"HWSZ00100"+(l%3+1),productName:["粉色碳碳富盒挂件","蓝色小熊玩偶","绿色恐龙模型"][l%3],productionBatch:"2025-06-"+(10+l),manufacturer:["扬州中韵工艺品有限公司","深圳乐高玩具厂","广州童趣玩具公司"][l%3],unitPrice:[25.8,30.5,18.2][l%3],quantity:[200,150,300][l%3],totalPrice:["5,160","4,575","5,460"][l%3],creator:["33","44","55"][l%3],createTime:"2025-7-13 19:25:"+(10+l),updateTime:"2025-7-13 19:30:"+(10+l),deviceModel:["A100","B200","C300"][l%3],productType:["益智","毛绒","模型"][l%3],ipName:["迪士尼","漫威","宝可梦"][l%3]});console.log("Raw Data:",b);const z=u({key:"all",label:"全部",value:"all"}),m=u({key:"all",label:"全部",value:"all"}),p=u({key:"all",label:"全部",value:"all"}),G=y(()=>{const l=Array.from(new Set(b.map(e=>e.deviceModel)));return[{key:"all",value:"all",label:"全部"},...l.map(e=>({key:e,value:e,label:e}))]}),X=y(()=>{const l=Array.from(new Set(b.map(e=>e.productName)));return[{key:"all",value:"all",label:"全部"},...l.map(e=>({key:e,value:e,label:e}))]}),Y=y(()=>{const l=Array.from(new Set(b.map(e=>e.manufacturer)));return[{key:"all",value:"all",label:"全部"},...l.map(e=>({key:e,value:e,label:e}))]}),ee=l=>{m.value=!l||!l.value||l.value==="all"?{key:"all",label:"全部",value:"all"}:l},le=l=>{p.value=!l||!l.value||l.value==="all"?{key:"all",label:"全部",value:"all"}:l},S=u(1),O=u(10);console.log("Initial deviceModelValue:",z.value);const _=u({columnKey:"updateTime",order:"descend"}),te=y(()=>({total:R.value.length,current:S.value,pageSize:O.value,showSizeChanger:!0,pageSizeOptions:["10","20","50"],showTotal:(l,e)=>`第${e[0]}-${e[1]}条/共${l}条`,showQuickJumper:{goButton:"页"},onShowSizeChange:(l,e)=>{console.log("onShowSizeChange",l,e),S.value=l,O.value=e},onChange:(l,e)=>{console.log("onChange",l,e),S.value=l,O.value=e}})),ae=()=>{console.log("Refresh button clicked!"),D.value=!0,M.value="",S.value=1,E(),z.value={key:"all",label:"全部",value:"all"},m.value={key:"all",label:"全部",value:"all"},p.value={key:"all",label:"全部",value:"all"},setTimeout(()=>{D.value=!1},500)},M=u(""),P=u("");let V=null;Me(M,l=>{V&&clearTimeout(V),V=setTimeout(()=>{P.value=l},300)});const R=y(()=>{var e;let l=[...b];if(P.value){const a=P.value.toLowerCase();l=l.filter(s=>Object.values(s).some(r=>typeof r=="string"&&r.toLowerCase().includes(a)))}if(m.value&&m.value.value!=="all"&&m.value.value!==""&&(l=l.filter(a=>a.productName===m.value.value)),p.value&&p.value.value!=="all"&&p.value.value!==""&&(l=l.filter(a=>a.manufacturer===p.value.value)),_.value&&_.value.order){const{columnKey:a,order:s}=_.value,r=(e=v.find(c=>c.key===a))==null?void 0:e.sorter;r&&l.sort((c,C)=>{const w=r(c,C);return s==="ascend"?w:-w})}return l}),A=(l,e,a)=>{console.log("Table change:",l,e,a);const s=Array.isArray(a)?a[0]:a;s&&s.order?_.value={columnKey:s.columnKey,order:s.order}:_.value={columnKey:"updateTime",order:"descend"},S.value=1},oe=()=>{console.log("Setting clicked")},D=u(!1),U=u("middle"),ne=({key:l})=>{U.value=l},E=()=>{f.value=v.map(l=>l.key),k.value=v.map(l=>l.key)},ie=l=>{const{newIndex:e,oldIndex:a}=l,s=k.value[a],r=[...k.value];r.splice(a,1),r.splice(e,0,s),k.value=r},se=(l,e)=>{e?f.value.includes(l)||f.value.push(l):f.value=f.value.filter(a=>a!==l)},N=u(!1),ue=y(()=>Array.from(new Set(b.map(l=>l.deviceModel)))),de=()=>{N.value=!1},re=l=>{N.value=!1},q=u(!1),B=u(null),K=l=>{qe.info("开发中")},ce=()=>{q.value=!1,B.value=null},me=l=>{q.value=!1,B.value=null},F=u(!1),pe=l=>{F.value=!1},I=u(!1),ve=()=>{I.value=!1};return Oe(()=>{f.value=v.map(l=>l.key)}),J({handleTableChange:A}),(l,e)=>{const a=i("a-select-option"),s=i("a-select"),r=i("a-tooltip"),c=i("a-input"),C=i("a-button"),w=i("a-menu-item"),fe=i("a-menu"),_e=i("a-dropdown"),ye=i("a-checkbox"),he=i("a-popover"),ke=i("a-divider"),be=i("a-popconfirm"),ge=i("a-space"),Ce=i("a-table"),T=i("a-form-item"),we=i("a-date-picker"),xe=i("a-form"),Se=i("a-modal"),Ie=i("a-config-provider");return L(),j(Ie,{locale:Q.value,theme:{algorithm:x(Fe).defaultAlgorithm}},{default:o(()=>[e[20]||(e[20]=d("div",{class:"title-container"},[d("h2",null,"玩具生产")],-1)),d("div",je,[d("div",Le,[d("div",He,[e[10]||(e[10]=d("span",{class:"select-always-placeholder"},"产品名称:",-1)),t(r,{title:m.value.label},{default:o(()=>[t(s,{value:m.value,"onUpdate:value":e[0]||(e[0]=n=>m.value=n),style:{width:"120px"},options:X.value,onChange:ee,allowClear:!0,"label-in-value":"",class:"product-name-select"},{default:o(()=>[t(a,{value:"all"},{default:o(()=>e[9]||(e[9]=[h("全部")])),_:1,__:[9]})]),_:1},8,["value","options"])]),_:1},8,["title"])]),d("div",Je,[e[12]||(e[12]=d("span",{class:"select-always-placeholder"},"生产厂家:",-1)),t(r,{title:p.value.label},{default:o(()=>[t(s,{value:p.value,"onUpdate:value":e[1]||(e[1]=n=>p.value=n),style:{width:"120px"},options:Y.value,onChange:le,allowClear:!0,"label-in-value":"",class:"manufacturer-select"},{default:o(()=>[t(a,{value:"all"},{default:o(()=>e[11]||(e[11]=[h("全部")])),_:1,__:[11]})]),_:1},8,["value","options"])]),_:1},8,["title"])])]),d("div",Qe,[t(c,{modelValue:M.value,"onUpdate:modelValue":e[2]||(e[2]=n=>M.value=n),placeholder:"输入关键字搜索",style:{width:"200px"}},{prefix:o(()=>[t(x(Pe))]),_:1},8,["modelValue"]),t(C,{type:"primary",onClick:e[3]||(e[3]=n=>I.value=!0)},{default:o(()=>e[13]||(e[13]=[h("新增批次")])),_:1,__:[13]}),t(x(Ve),{onClick:ae}),t(_e,null,{overlay:o(()=>[t(fe,{onClick:ne},{default:o(()=>[t(w,{key:"large"},{default:o(()=>e[14]||(e[14]=[h("宽松")])),_:1,__:[14]}),t(w,{key:"middle"},{default:o(()=>e[15]||(e[15]=[h("中等")])),_:1,__:[15]}),t(w,{key:"small"},{default:o(()=>e[16]||(e[16]=[h("紧凑")])),_:1,__:[16]})]),_:1})]),default:o(()=>[t(x($e),{onClick:e[4]||(e[4]=Re(()=>{},["prevent"]))})]),_:1}),t(he,{trigger:"click",placement:"bottomRight"},{content:o(()=>[d("div",We,[d("div",Ze,[d("div",Ge,[e[18]||(e[18]=d("span",null,"列展示",-1)),t(C,{type:"link",onClick:E},{default:o(()=>e[17]||(e[17]=[h("重置")])),_:1,__:[17]})]),t(x(ze),{modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=n=>k.value=n),"item-key":"key",onEnd:ie,class:"column-checkbox-group"},{item:o(({element:n})=>[d("div",Xe,[t(ye,{checked:f.value.includes(n),onChange:g=>se(n,g.target.checked)},{default:o(()=>{var g;return[h(De((g=v.find($=>$.key===n))==null?void 0:g.title),1)]}),_:2},1032,["checked","onChange"])])]),_:1},8,["modelValue"])])])]),default:o(()=>[t(x(Ke),{onClick:oe})]),_:1})])]),d("div",Ye,[t(Ce,{columns:Z.value,"data-source":R.value,pagination:R.value.length===0?!1:te.value,loading:D.value,size:U.value,scroll:{x:1e3},onChange:A,showSorterTooltip:!1,onEditRecord:K},{bodyCell:o(({column:n,record:g})=>[n.key==="operation"?(L(),j(ge,{key:0,class:"action-cell",direction:"horizontal"},{default:o(()=>[d("a",{class:"edit-link",onClick:$=>K(g)},"编辑",8,el),t(ke,{type:"vertical"}),t(be,{title:"确定要删除该信息吗?",onConfirm:$=>l.$emit("delete-record",g)},{default:o(()=>e[19]||(e[19]=[d("a",{class:"danger-link"},"删除",-1)])),_:2,__:[19]},1032,["onConfirm"])]),_:2},1024)):Ne("",!0)]),_:1},8,["columns","data-source","pagination","loading","size"])]),t(Ae,{visible:N.value,uniqueDeviceModels:ue.value,"onUpdate:visible":de,onSubmit:re},null,8,["visible","uniqueDeviceModels"]),t(Ue,{visible:q.value,record:B.value,"onUpdate:visible":ce,onSubmit:me},null,8,["visible","record"]),t(Ee,{visible:F.value,"onUpdate:visible":e[6]||(e[6]=n=>F.value=n),deviceModelOptions:G.value,ipNameOptions:[],onSubmit:pe},null,8,["visible","deviceModelOptions"]),t(Se,{visible:I.value,"onUpdate:visible":e[7]||(e[7]=n=>I.value=n),title:"新增批次",onOk:ve,onCancel:e[8]||(e[8]=n=>I.value=!1),width:"400px"},{default:o(()=>[t(xe,{layout:"vertical"},{default:o(()=>[t(T,{required:"",label:"产品名称"},{default:o(()=>[t(s,{placeholder:"请选择"})]),_:1}),t(T,{required:"",label:"生产批次"},{default:o(()=>[t(we,{style:{width:"100%"},placeholder:"请选择"})]),_:1}),t(T,{label:"生产厂家"},{default:o(()=>[t(c,{placeholder:"请输入"})]),_:1}),t(T,{required:"",label:"单价"},{default:o(()=>[t(c,{suffix:"元",placeholder:"请输入"})]),_:1}),t(T,{required:"",label:"数量"},{default:o(()=>[t(c,{suffix:"个",placeholder:"请输入"})]),_:1})]),_:1})]),_:1},8,["visible"])]),_:1,__:[20]},8,["locale","theme"])}}}),rl=Be(ll,[["__scopeId","data-v-1b5e22b3"]]);export{rl as default};
