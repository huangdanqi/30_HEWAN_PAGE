# 设备导入 Excel 文件格式指南

## 概述
本指南说明如何准备Excel文件以导入设备信息到设备管理系统。

## 支持的Excel格式
- `.xlsx` (推荐)
- `.xls`

## 文件大小限制
- 最大文件大小：50MB

## 必需列结构

Excel文件必须包含以下列（按顺序）：

| 列序号 | 列名 | 说明 | 是否必需 | 示例 |
|--------|------|------|----------|------|
| 1 | 设备ID | 设备的唯一标识符 | ✅ 必需 | `0075A1B2SZTDS25061982X01` |
| 2 | 绑定子账户 | 绑定的子账户信息 | ❌ 可选 | `183****7953` |
| 3 | 初始烧录固件 | 设备初始固件版本 | ❌ 可选 | `HW2001 V 1.0.1` |
| 4 | 最新可更新固件 | 最新可用固件版本 | ❌ 可选 | `HW2001 V 2.0.1` |
| 5 | 当前固件版本 | 当前安装的固件版本 | ❌ 可选 | `HW2001 V 1.3.0` |
| 6 | SN码 | 设备序列号 | ❌ 可选 | `SZTDS25061982X01` |
| 7 | 芯片ID | 设备芯片标识 | ❌ 可选 | `ESP32-0075A1B01` |
| 8 | Wi-Fi MAC地址 | Wi-Fi模块MAC地址 | ❌ 可选 | `DC:54:75:62:01:70` |
| 9 | 蓝牙MAC地址 | 蓝牙模块MAC地址 | ❌ 可选 | `DC:54:75:62:01:70` |
| 10 | 蓝牙名称 | 蓝牙设备名称 | ❌ 可选 | `ZBMU 001 250619X01` |
| 11 | 蜂窝网络识别码 | 蜂窝网络ID | ❌ 可选 | `353801003000174` |
| 12 | 4G卡号 | 4G SIM卡号 | ❌ 可选 | `14776294300136` |
| 13 | CPU序列号 | CPU序列号 | ❌ 可选 | `0xFFFFFF6B` |

## 导入流程

### 第一步：选择基本信息
1. **设备型号**: 选择要导入的设备型号
2. **生产批次**: 选择生产批次
3. **生产厂家**: 选择生产厂家

### 第二步：上传Excel文件
1. 点击"选择文件"或拖拽Excel文件到上传区域
2. 系统自动验证文件格式和内容
3. 点击"导入"开始处理

## 数据验证规则

### 必需字段验证
- 设备ID不能为空
- 设备ID必须唯一（如果已存在则更新）

### 数据格式验证
- 日期格式：YYYY-MM-DD
- MAC地址格式：XX:XX:XX:XX:XX:XX
- 固件版本格式：建议使用标准版本号格式

## 示例Excel文件

### 表头行（第一行）
```
设备ID	绑定子账户	初始烧录固件	最新可更新固件	当前固件版本	SN码	芯片ID	Wi-Fi MAC地址	蓝牙MAC地址	蓝牙名称	蜂窝网络识别码	4G卡号	CPU序列号
```

### 数据行示例
```
0075A1B2SZTDS25061982X01	183****7953	HW2001 V 1.0.1	HW2001 V 2.0.1	HW2001 V 1.3.0	SZTDS25061982X01	ESP32-0075A1B01	DC:54:75:62:01:70	DC:54:75:62:01:70	ZBMU 001 250619X01	353801003000174	14776294300136	0xFFFFFF6B
0075A1B2SZTDS25061982X02	-	HW2001 V 1.0.1	HW2001 V 2.0.1	HW2001 V 1.3.0	SZTDS25061982X02	ESP32-0075A1B02	DC:54:75:62:02:70	DC:54:75:62:02:70	ZBMU 001 250619X02	353801003000274	14776294300236	0xFFFFFF6A
```

## 注意事项

### 数据完整性
- 确保每行都有设备ID
- 空值可以用"-"表示或留空
- 系统会自动填充缺失的固件信息

### 重复处理
- 如果设备ID已存在，系统会更新现有记录
- 如果设备ID不存在，系统会创建新记录

### 错误处理
- 导入过程中出现错误的行会被记录
- 成功的行会正常导入
- 系统会显示详细的导入结果

## 常见问题

### Q: 为什么导入失败？
A: 请检查：
- Excel文件格式是否正确
- 是否包含必需的列
- 设备ID是否为空
- 文件大小是否超过50MB

### Q: 如何处理重复的设备ID？
A: 系统会自动处理：
- 如果设备ID已存在，会更新现有记录
- 如果设备ID不存在，会创建新记录

### Q: 导入后数据在哪里？
A: 导入成功后，数据会立即显示在设备管理列表中，并自动刷新页面。

## 技术支持

如果遇到问题，请：
1. 检查浏览器控制台的错误信息
2. 确认Excel文件格式符合要求
3. 联系系统管理员获取支持
