import{d as ue,r as s,p as E,a as he,j as M,i as Q,o as h,f as i,w as l,c as B,e as t,b as n,g as u,F as L,n as me,l as O,t as de,C as xe,E as Se,q as Me,_ as ce,k as Oe,S as Ie,R as Fe,m as Ve}from"./index-CtWBKoTV.js";import{l as pe,t as $e,C as Te,d as Ae}from"./vuedraggable.umd-BEfuS-FY.js";import{I as Be}from"./InboxOutlined-BOa_tbmU.js";import{S as De}from"./SettingOutlined-adrFa0AU.js";const Ue={style:{display:"flex","justify-content":"flex-end",gap:"8px","margin-top":"16px"}},Ne={class:"upload-area"},Ee={class:"upload-icon"},Re={key:0,class:"file-progress"},qe={class:"file-name-row"},ze={class:"upload-actions"},je={key:2,class:"result-area"},Pe={class:"result-icon success"},Ze={class:"result-icon warning"},Ge={class:"result-icon error"},Le={class:"result-actions"},Xe=ue({__name:"DeviceImportModal",props:{visible:Boolean,deviceModelOptions:{type:Array,default:()=>[]},productionBatchOptions:{type:Array,default:()=>[]},manufacturerOptions:{type:Array,default:()=>[]}},emits:["update:visible","finish"],setup(x,{emit:R}){const f=x,v=R,c=s(f.visible);E(()=>f.visible,S=>{c.value=S}),E(c,S=>{S||v("update:visible",!1)});const p=s(0),I=s(),d=he({deviceModel:"",productionBatch:"",manufacturer:"",burnedFirmware:""}),_={deviceModel:[{required:!0,message:"请选择设备型号"}],productionBatch:[{required:!0,message:"请选择生产批次"}],manufacturer:[{required:!0,message:"请选择生产厂家"}],burnedFirmware:[{required:!0,message:"请输入烧录固件"}]},y=s([]),k=s(""),w=s(0),g=s("success"),q=M(()=>p.value===0?"设备导入-第一步":p.value===1?"设备导入-第二步":"");function z(){I.value.validate().then(()=>{p.value=1})}function T(){p.value=0}function V(){v("update:visible",!1),H()}function j(){v("finish"),H()}function P(S){return k.value=S.name,w.value=0,!1}function Y(S){w.value=0,k.value=S.file.name;const o=setInterval(()=>{w.value<100?w.value+=10:clearInterval(o)},100)}function X(){g.value==="success"?g.value="duplicate":g.value==="duplicate"?g.value="error":g.value="success",p.value=2}function ee(){alert("下载重复文件")}function te(){alert("下载异常文件")}function H(){p.value=0,k.value="",w.value=0,g.value="success",d.deviceModel="",d.productionBatch="",d.manufacturer="",d.burnedFirmware=""}return(S,o)=>{const $=i("a-step"),D=i("a-steps"),Z=i("a-select"),U=i("a-form-item"),ae=i("a-input"),b=i("a-button"),le=i("a-form"),oe=i("a-upload-dragger"),N=i("a-progress"),J=i("a-file-excel-outlined"),K=i("a-modal");return h(),Q(K,{visible:c.value,title:q.value,footer:null,width:540,onCancel:V,class:"device-import-modal"},{default:l(()=>[p.value===0?(h(),B(L,{key:0},[t(D,{current:0,size:"small",style:{"margin-bottom":"24px"}},{default:l(()=>[t($,{title:"设备录入"}),t($,{title:"文件导入"})]),_:1}),t(le,{model:d,rules:_,ref_key:"formRef",ref:I,layout:"vertical"},{default:l(()=>[t(U,{label:"设备型号",name:"deviceModel",required:""},{default:l(()=>[t(Z,{value:d.deviceModel,"onUpdate:value":o[0]||(o[0]=F=>d.deviceModel=F),options:x.deviceModelOptions,placeholder:"请选择","allow-clear":""},null,8,["value","options"])]),_:1}),t(U,{label:"生产批次",name:"productionBatch",required:""},{default:l(()=>[t(Z,{value:d.productionBatch,"onUpdate:value":o[1]||(o[1]=F=>d.productionBatch=F),options:x.productionBatchOptions,placeholder:"请选择","allow-clear":""},null,8,["value","options"])]),_:1}),t(U,{label:"生产厂家",name:"manufacturer",required:""},{default:l(()=>[t(Z,{value:d.manufacturer,"onUpdate:value":o[2]||(o[2]=F=>d.manufacturer=F),options:x.manufacturerOptions,placeholder:"请选择","allow-clear":""},null,8,["value","options"])]),_:1}),t(U,{label:"烧录固件",name:"burnedFirmware",required:""},{default:l(()=>[t(ae,{value:d.burnedFirmware,"onUpdate:value":o[3]||(o[3]=F=>d.burnedFirmware=F),placeholder:"请输入"},null,8,["value"])]),_:1}),n("div",Ue,[t(b,{onClick:V},{default:l(()=>o[4]||(o[4]=[u("取消")])),_:1,__:[4]}),t(b,{type:"primary",onClick:z},{default:l(()=>o[5]||(o[5]=[u("下一步")])),_:1,__:[5]})])]),_:1},8,["model"])],64)):p.value===1?(h(),B(L,{key:1},[t(D,{current:1,size:"small",style:{"margin-bottom":"24px"}},{default:l(()=>[t($,{title:"设备录入"}),t($,{title:"文件导入"})]),_:1}),n("div",Ne,[t(oe,{"file-list":y.value,"before-upload":P,"custom-request":Y,"show-upload-list":!1},{default:l(()=>[n("div",Ee,[t(O(Be),{style:{"font-size":"48px",color:"#1677ff","margin-bottom":"8px"}})]),o[6]||(o[6]=n("div",{class:"upload-text"},"点击或拖拽文件到此区域上传",-1)),o[7]||(o[7]=n("div",{class:"upload-hint"},"请上传设备导入文件，支持格式：xls、xlsx。",-1))]),_:1,__:[6,7]},8,["file-list"]),k.value?(h(),B("div",Re,[t(N,{percent:w.value,"show-info":!0,style:{width:"90%",margin:"0 auto"}},null,8,["percent"]),n("div",qe,[n("span",null,[t(J,{style:{color:"#52c41a","margin-right":"4px"}}),u(de(k.value),1)]),n("span",null,de(w.value)+"%",1)])])):me("",!0),n("div",ze,[t(b,{onClick:T},{default:l(()=>o[8]||(o[8]=[u("上一步")])),_:1,__:[8]}),t(b,{type:"primary",disabled:!k.value||w.value<100,onClick:X},{default:l(()=>o[9]||(o[9]=[u("确定")])),_:1,__:[9]},8,["disabled"])])])],64)):(h(),B("div",je,[g.value==="success"?(h(),B(L,{key:0},[n("div",Pe,[t(O(xe))]),o[10]||(o[10]=n("div",{class:"result-title"},"导入成功",-1)),o[11]||(o[11]=n("div",{class:"result-desc"},"已成功导入XX条设备信息数据",-1))],64)):g.value==="duplicate"?(h(),B(L,{key:1},[n("div",Ze,[t(O(Se))]),o[13]||(o[13]=n("div",{class:"result-title"},"导入数据重复",-1)),o[14]||(o[14]=n("div",{class:"result-desc"},"发现XX条数据重复，设备ID不可重复，如继续导入，等重复数据跳过。请确认，下载重复文件。",-1)),t(b,{type:"link",onClick:ee},{default:l(()=>o[12]||(o[12]=[u("下载重复文件")])),_:1,__:[12]})],64)):(h(),B(L,{key:2},[n("div",Ge,[t(O(Me))]),o[16]||(o[16]=n("div",{class:"result-title"},"导入失败",-1)),o[17]||(o[17]=n("div",{class:"result-desc"},"导入失败，部分数据格式或数据类型不正确，部分必填字段未填写，且部分数据重复。请下载异常文件。",-1)),t(b,{type:"link",onClick:te},{default:l(()=>o[15]||(o[15]=[u("下载异常文件")])),_:1,__:[15]})],64)),n("div",Le,[t(b,{onClick:V},{default:l(()=>o[18]||(o[18]=[u("取消")])),_:1,__:[18]}),t(b,{type:"primary",onClick:j},{default:l(()=>o[19]||(o[19]=[u("确定")])),_:1,__:[19]})])]))]),_:1},8,["visible","title"])}}}),He=ce(Xe,[["__scopeId","data-v-c9fae0e6"]]),Je={style:{display:"flex","justify-content":"center",gap:"16px","margin-top":"24px"}},Ke=ue({__name:"OtaConfigModal",props:{visible:Boolean,deviceModelOptions:Array,latestFirmwareOptions:Array,deviceModelValue:[String,Number,Object],latestFirmwareValue:[String,Number,Object]},emits:["update:visible","ok","update:deviceModelValue","update:latestFirmwareValue"],setup(x,{emit:R}){const f=x,v=R,c=s(f.deviceModelValue),p=s(f.latestFirmwareValue);E(()=>f.deviceModelValue,_=>{c.value=_}),E(()=>f.latestFirmwareValue,_=>{p.value=_}),E(c,_=>{v("update:deviceModelValue",_)}),E(p,_=>{v("update:latestFirmwareValue",_)});function I(){v("update:visible",!1)}function d(){v("ok",{deviceModelValue:c.value,latestFirmwareValue:p.value})}return(_,y)=>{const k=i("a-select"),w=i("a-form-item"),g=i("a-button"),q=i("a-form"),z=i("a-modal");return h(),Q(z,{visible:x.visible,title:"OTA配置",footer:null,width:500,onCancel:I,class:"ota-config-modal"},{default:l(()=>[t(q,{layout:"vertical"},{default:l(()=>[t(w,{label:"设备型号",required:""},{default:l(()=>[t(k,{options:x.deviceModelOptions,value:c.value,"onUpdate:value":y[0]||(y[0]=T=>c.value=T),placeholder:"请选择",style:{width:"100%"}},null,8,["options","value"])]),_:1}),t(w,{label:"最新固件",required:""},{default:l(()=>[t(k,{options:x.latestFirmwareOptions,value:p.value,"onUpdate:value":y[1]||(y[1]=T=>p.value=T),placeholder:"请选择",style:{width:"100%"}},null,8,["options","value"])]),_:1}),n("div",Je,[t(g,{onClick:I},{default:l(()=>y[2]||(y[2]=[u("取消")])),_:1,__:[2]}),t(g,{type:"primary",onClick:d},{default:l(()=>y[3]||(y[3]=[u("确定")])),_:1,__:[3]})])]),_:1})]),_:1},8,["visible"])}}}),We=ce(Ke,[["__scopeId","data-v-8e4e7a8c"]]),Qe={class:"top-controls-wrapper"},Ye={class:"left-aligned-section"},et={class:"select-container device-model-select",style:{"margin-left":"10px"}},tt={class:"select-container manufacturer-select",style:{"margin-left":"10px"}},at={class:"right-aligned-icons"},lt={class:"column-setting-panel",style:{"max-height":"300px","overflow-y":"auto"}},ot={class:"setting-section"},nt={class:"section-header",style:{display:"flex","justify-content":"space-between"}},it={class:"column-checkbox-item",style:{padding:"4px 0"}},st={class:"table-container"},rt=["onClick"],dt=ue({__name:"OTA",setup(x){const R=M(()=>({...pe,Pagination:{...pe.Pagination,page:""}})),f=[{key:"rowIndex",title:"序号",dataIndex:"rowIndex",width:60,fixed:"left",customRender:({index:a})=>($.value-1)*D.value+a+1},{key:"deviceId",title:"设备ID",dataIndex:"deviceId",width:200},{key:"bindAccount",title:"绑定子账户",dataIndex:"bindAccount",width:120},{key:"deviceModel",title:"设备型号",dataIndex:"deviceModel",width:100},{key:"productionBatch",title:"生产批次",dataIndex:"productionBatch",width:120},{key:"manufacturer",title:"生产厂家",dataIndex:"manufacturer",width:180},{key:"initFirmware",title:"初始固件",dataIndex:"initFirmware",width:120},{key:"latestFirmware",title:"最新固件",dataIndex:"latestFirmware",width:120},{key:"currentFirmware",title:"当前固件版本",dataIndex:"currentFirmware",width:120},{key:"sn",title:"SN码",dataIndex:"sn",width:180},{key:"efuseId",title:"eFuse ID",dataIndex:"efuseId",width:180},{key:"mac",title:"MAC地址",dataIndex:"mac",width:160},{key:"tempName",title:"蓝牙名称",dataIndex:"tempName",width:160},{key:"imei",title:"IMEI",dataIndex:"imei",width:160},{key:"sim",title:"4G卡号",dataIndex:"sim",width:160},{key:"cpu",title:"CPU序列",dataIndex:"cpu",width:120},{key:"creator",title:"创建人",dataIndex:"creator",width:80},{key:"createTime",title:"创建时间",dataIndex:"createTime",width:160,sorter:(a,e)=>a.createTime.localeCompare(e.createTime),sortDirections:["ascend","descend"]},{key:"updateTime",title:"更新时间",dataIndex:"updateTime",width:160,sorter:(a,e)=>a.updateTime.localeCompare(e.updateTime),sortDirections:["ascend","descend"],defaultSortOrder:"descend"}],v=s(f.map(a=>a.key)),c=s(f.map(a=>a.key)),p=M(()=>c.value.map(e=>f.find(m=>m.key===e)).filter(e=>!!e&&v.value.includes(e.key)).map(e=>({title:e.title,dataIndex:e.dataIndex,key:e.key,width:e.width,fixed:e.fixed,sorter:e.sorter,sortDirections:e.sortDirections,sortOrder:d.value&&e.key===d.value.columnKey?d.value.order:void 0,defaultSortOrder:e.defaultSortOrder,customRender:e.customRender?e.customRender:({text:C})=>C==null||C===""?"-":C,className:e.className}))),I=s([]),d=s({columnKey:"updateTime",order:"descend"});Oe(async()=>{I.value=[...G],console.log("Raw Data:",I.value)});const _=s({value:"all",label:"全部"}),y=s({value:"all",label:"全部"}),k=M(()=>{const a=new Set;return G.forEach(e=>{e.deviceModel&&a.add(e.deviceModel)}),Array.from(a).map(e=>({label:e,value:e}))}),w=a=>{a&&a.value?console.log("Selected Device Model:",a.label):console.log("Device Model cleared")},g=M(()=>{const a=new Set;return G.forEach(e=>{e.manufacturer&&a.add(e.manufacturer)}),Array.from(a).map(e=>({label:e,value:e}))}),q=a=>{a&&a.value?console.log("Selected Manufacturer:",a.label):console.log("Manufacturer cleared")},z=M(()=>{const a=new Set;return G.forEach(e=>{e.productionBatch&&a.add(e.productionBatch)}),Array.from(a).map(e=>({label:e,value:e}))}),T=M(()=>{const a=new Set;return G.forEach(e=>{e.latestFirmware&&a.add(e.latestFirmware)}),Array.from(a).map(e=>({label:e,value:e}))}),V=s(""),j=M(()=>{let a=I.value;return V.value&&(a=a.filter(e=>Object.values(e).some(m=>String(m).toLowerCase().includes(V.value.toLowerCase())))),a}),P=s(!1),Y=()=>{P.value=!0,setTimeout(()=>{P.value=!1},1e3)},X=s("middle"),ee=a=>{(a.key==="large"||a.key==="middle"||a.key==="small")&&(X.value=a.key)},te=()=>{console.log("Settings icon clicked")},H=()=>{v.value=f.map(a=>a.key),c.value=f.map(a=>a.key)},S=(a,e)=>{e?v.value.push(a):v.value=v.value.filter(m=>m!==a)},o=a=>{const{oldIndex:e,newIndex:m}=a,C=c.value.splice(e,1)[0];c.value.splice(m,0,C)},$=s(1),D=s(10),Z=M(()=>j.value.length),U=M(()=>({total:Z.value,current:$.value,pageSize:D.value,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["10","20","30","40","50","100"],showTotal:a=>`共 ${a} 条`,position:["bottomRight"]})),ae=(a,e,m)=>{console.log("Table changed:",a,e,m),$.value=a.current,D.value=a.pageSize,d.value=m},b=s(!1),le=()=>{b.value=!0},oe=a=>{console.log("Device import finished with values:",a),b.value=!1},N=s(!1),J=s(),K=s(),F=()=>{console.log("OTA Config OK"),N.value=!1},G=Array.from({length:100},(a,e)=>{const m=25+Math.floor(e/60),C=e%60,W=30+Math.floor(e/60),ne=e%60;return{key:e+1,accountId:`jkhg824&3*g${e+1}`,phoneNumber:`183****795${e%10}`,deviceModel:"HWSZ001",deviceId:`0075A1B2SZTDS250619B2X9J${e.toString().padStart(2,"0")}`,productId:`hjhtwn832nj${e+1}`,ipRole:`王龙${e+1}`,productModel:`HWSZ00100${e+1}`,currentMemberType:e%3===0?"VIP":e%2===0?"普通会员":"SVIP",memberPayment:e%2===0?"自动续费":"赠送",memberActivationTime:"2025-06-01 10:00:00",memberExpirationTime:"2026-06-01 10:00:00",fourGCardNumber:`147762943013${e.toString().padStart(2,"0")}`,fourGPlan:e%2===0?"500M/月":"1G/月",remainingDataThisMonth:`${e*10}M`,fourGPayment:e%2===0?"自动续费":"赠送",fourGActivationTime:"2025-06-01 10:00:00",fourGExpirationTime:"2026-06-01 10:00:00",serviceAnnualFeeBalance:26.35,asrAnnualUsage:"384,3848 tokens",llmAnnualUsage:"384,3848 tokens",ttsAnnualUsage:"213.55 h",voiceCloneAnnualUsage:"213.55 h",registrationTime:"2025-06-01 10:00:00",bindAccount:e%4===0?"-":`183****795${e%10}`,productionBatch:"2025-06-30",manufacturer:"深圳天德胜科技有限公司",initFirmware:"Z001 V 1.0.1",latestFirmware:"Z001 V 2.0.1",currentFirmware:"Z001 V 1.3.0",sn:`SZTDS250619B2X9J${e.toString().padStart(2,"0")}`,efuseId:`ESP32-0075A1B${e.toString().padStart(2,"0")}`,mac:`DC:54:75:62:66:7${e%10}`,tempName:`Zibbi 001 250619B${e.toString().padStart(2,"0")}`,imei:`3538010036017${e.toString().padStart(2,"0")}`,sim:`147762943013${e.toString().padStart(2,"0")}`,cpu:`0x1FFFF7E${e+8}`,creator:"33",createTime:`2025-07-13 19:${String(m).padStart(2,"0")}:${String(C).padStart(2,"0")}`,updateTime:`2025-07-13 19:${String(W).padStart(2,"0")}:${String(ne).padStart(2,"0")}`}});return(a,e)=>{const m=i("a-select-option"),C=i("a-select"),W=i("a-tooltip"),ne=i("a-input"),ie=i("a-button"),se=i("a-menu-item"),ve=i("a-menu"),fe=i("a-dropdown"),_e=i("a-checkbox"),ye=i("a-popover"),ge=i("a-divider"),ke=i("a-popconfirm"),we=i("a-space"),be=i("a-table"),Ce=i("a-config-provider");return h(),Q(Ce,{locale:R.value,theme:{algorithm:O($e).defaultAlgorithm}},{default:l(()=>[e[22]||(e[22]=n("div",{class:"title-container"},[n("h2",null,"设备OTA")],-1)),n("div",Qe,[n("div",Ye,[n("div",et,[e[11]||(e[11]=n("span",{class:"select-always-placeholder"},"设备型号:",-1)),t(W,{title:_.value.label},{default:l(()=>[t(C,{value:_.value,"onUpdate:value":e[0]||(e[0]=r=>_.value=r),style:{width:"120px"},options:k.value,onChange:w,allowClear:!0,"label-in-value":""},{default:l(()=>[t(m,{value:"all"},{default:l(()=>e[10]||(e[10]=[u("全部")])),_:1,__:[10]})]),_:1},8,["value","options"])]),_:1},8,["title"])]),n("div",tt,[e[13]||(e[13]=n("span",{class:"select-always-placeholder"},"生产厂家:",-1)),t(W,{title:y.value.label},{default:l(()=>[t(C,{value:y.value,"onUpdate:value":e[1]||(e[1]=r=>y.value=r),style:{width:"120px"},options:g.value,onChange:q,allowClear:!0,"label-in-value":""},{default:l(()=>[t(m,{value:"all"},{default:l(()=>e[12]||(e[12]=[u("全部")])),_:1,__:[12]})]),_:1},8,["value","options"])]),_:1},8,["title"])])]),n("div",at,[t(ne,{value:V.value,"onUpdate:value":e[2]||(e[2]=r=>V.value=r),placeholder:"输入关键字搜索",style:{width:"200px"}},{prefix:l(()=>[t(O(Ie))]),_:1},8,["value"]),t(ie,{type:"primary",onClick:le},{default:l(()=>e[14]||(e[14]=[u("设备导入")])),_:1,__:[14]}),t(ie,{type:"primary",onClick:e[3]||(e[3]=r=>N.value=!0)},{default:l(()=>e[15]||(e[15]=[u("OTA配置")])),_:1,__:[15]}),t(O(Fe),{onClick:Y}),t(fe,null,{overlay:l(()=>[t(ve,{onClick:ee},{default:l(()=>[t(se,{key:"large"},{default:l(()=>e[16]||(e[16]=[u("宽松")])),_:1,__:[16]}),t(se,{key:"middle"},{default:l(()=>e[17]||(e[17]=[u("中等")])),_:1,__:[17]}),t(se,{key:"small"},{default:l(()=>e[18]||(e[18]=[u("紧凑")])),_:1,__:[18]})]),_:1})]),default:l(()=>[t(O(Te),{onClick:e[4]||(e[4]=Ve(()=>{},["prevent"]))})]),_:1}),t(ye,{trigger:"click",placement:"bottomRight"},{content:l(()=>[n("div",lt,[n("div",ot,[n("div",nt,[e[20]||(e[20]=n("span",null,"列展示",-1)),t(ie,{type:"link",onClick:H},{default:l(()=>e[19]||(e[19]=[u("重置")])),_:1,__:[19]})]),t(O(Ae),{modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=r=>c.value=r),"item-key":"key",onEnd:o,class:"column-checkbox-group"},{item:l(({element:r})=>[n("div",it,[t(_e,{checked:v.value.includes(r),onChange:A=>S(r,A.target.checked)},{default:l(()=>{var A;return[u(de((A=f.find(re=>re.key===r))==null?void 0:A.title),1)]}),_:2},1032,["checked","onChange"])])]),_:1},8,["modelValue"])])])]),default:l(()=>[t(O(De),{onClick:te})]),_:1})])]),n("div",st,[t(be,{columns:p.value,"data-source":j.value,pagination:j.value.length===0?!1:U.value,loading:P.value,size:X.value,scroll:{x:3e3},onChange:ae,showSorterTooltip:!1},{bodyCell:l(({column:r,record:A})=>[r.key==="operation_24"?(h(),Q(we,{key:0,class:"action-cell",direction:"horizontal"},{default:l(()=>[n("a",{class:"edit-link",onClick:re=>a.$emit("edit-record",A)},"编辑",8,rt),t(ge,{type:"vertical"}),t(ke,{title:"确定要删除该信息吗?",onConfirm:re=>a.$emit("delete-record",A)},{default:l(()=>e[21]||(e[21]=[n("a",{class:"danger-link"},"删除",-1)])),_:2,__:[21]},1032,["onConfirm"])]),_:2},1024)):me("",!0)]),_:1},8,["columns","data-source","pagination","loading","size"])]),t(He,{visible:b.value,"onUpdate:visible":e[6]||(e[6]=r=>b.value=r),deviceModelOptions:k.value,manufacturerOptions:g.value,productionBatchOptions:z.value,onFinish:oe},null,8,["visible","deviceModelOptions","manufacturerOptions","productionBatchOptions"]),t(We,{visible:N.value,"onUpdate:visible":e[7]||(e[7]=r=>N.value=r),deviceModelOptions:k.value,latestFirmwareOptions:T.value,deviceModelValue:J.value,"onUpdate:deviceModelValue":e[8]||(e[8]=r=>J.value=r),latestFirmwareValue:K.value,"onUpdate:latestFirmwareValue":e[9]||(e[9]=r=>K.value=r),onOk:F},null,8,["visible","deviceModelOptions","latestFirmwareOptions","deviceModelValue","latestFirmwareValue"])]),_:1,__:[22]},8,["locale","theme"])}}}),vt=ce(dt,[["__scopeId","data-v-21e27b4a"]]);export{vt as default};
