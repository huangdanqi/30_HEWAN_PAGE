import{d as re,r as s,p as E,a as he,j as M,i as K,o as C,f as i,w as a,c as B,e as t,b as n,g as u,F as X,n as pe,l as I,t as se,C as xe,E as Me,q as Ie,_ as de,k as Oe,S as Fe,R as Ve,m as $e}from"./index-BCGmAcLz.js";import{l as ce,t as Se,C as Ae,d as Te}from"./vuedraggable.umd-LclwGZ1c.js";import{I as Be}from"./InboxOutlined-Bj5fpIPV.js";import{S as De}from"./SettingOutlined-aohGgLY9.js";const Ue={style:{display:"flex","justify-content":"flex-end",gap:"8px","margin-top":"16px"}},Ne={class:"upload-area"},Ee={class:"upload-icon"},Re={key:0,class:"file-progress"},qe={class:"file-name-row"},ze={class:"upload-actions"},je={key:2,class:"result-area"},Pe={class:"result-icon success"},Ze={class:"result-icon warning"},Ge={class:"result-icon error"},Xe={class:"result-actions"},Le=re({__name:"DeviceImportModal",props:{visible:Boolean,deviceModelOptions:{type:Array,default:()=>[]},productionBatchOptions:{type:Array,default:()=>[]},manufacturerOptions:{type:Array,default:()=>[]}},emits:["update:visible","finish"],setup(h,{emit:R}){const v=h,m=R,c=s(v.visible);E(()=>v.visible,x=>{c.value=x}),E(c,x=>{x||m("update:visible",!1)});const p=s(0),O=s(),d=he({deviceModel:"",productionBatch:"",manufacturer:"",burnedFirmware:""}),f={deviceModel:[{required:!0,message:"请选择设备型号"}],productionBatch:[{required:!0,message:"请选择生产批次"}],manufacturer:[{required:!0,message:"请选择生产厂家"}],burnedFirmware:[{required:!0,message:"请输入烧录固件"}]},_=s([]),w=s(""),g=s(0),y=s("success"),q=M(()=>p.value===0?"设备导入-第一步":p.value===1?"设备导入-第二步":"");function z(){O.value.validate().then(()=>{p.value=1})}function A(){p.value=0}function $(){m("update:visible",!1),J()}function j(){m("finish"),J()}function P(x){return w.value=x.name,g.value=0,!1}function Q(x){g.value=0,w.value=x.file.name;const o=setInterval(()=>{g.value<100?g.value+=10:clearInterval(o)},100)}function L(){y.value==="success"?y.value="duplicate":y.value==="duplicate"?y.value="error":y.value="success",p.value=2}function Y(){alert("下载重复文件")}function ee(){alert("下载异常文件")}function J(){p.value=0,w.value="",g.value=0,y.value="success",d.deviceModel="",d.productionBatch="",d.manufacturer="",d.burnedFirmware=""}return(x,o)=>{const S=i("a-step"),D=i("a-steps"),Z=i("a-select"),U=i("a-form-item"),te=i("a-input"),b=i("a-button"),le=i("a-form"),ae=i("a-upload-dragger"),N=i("a-progress"),H=i("a-file-excel-outlined"),W=i("a-modal");return C(),K(W,{visible:c.value,title:q.value,footer:null,width:540,onCancel:$,class:"device-import-modal"},{default:a(()=>[p.value===0?(C(),B(X,{key:0},[t(D,{current:0,size:"small",style:{"margin-bottom":"24px"}},{default:a(()=>[t(S,{title:"设备录入"}),t(S,{title:"文件导入"})]),_:1}),t(le,{model:d,rules:f,ref_key:"formRef",ref:O,layout:"vertical"},{default:a(()=>[t(U,{label:"设备型号",name:"deviceModel",required:""},{default:a(()=>[t(Z,{value:d.deviceModel,"onUpdate:value":o[0]||(o[0]=F=>d.deviceModel=F),options:h.deviceModelOptions,placeholder:"请选择","allow-clear":""},null,8,["value","options"])]),_:1}),t(U,{label:"生产批次",name:"productionBatch",required:""},{default:a(()=>[t(Z,{value:d.productionBatch,"onUpdate:value":o[1]||(o[1]=F=>d.productionBatch=F),options:h.productionBatchOptions,placeholder:"请选择","allow-clear":""},null,8,["value","options"])]),_:1}),t(U,{label:"生产厂家",name:"manufacturer",required:""},{default:a(()=>[t(Z,{value:d.manufacturer,"onUpdate:value":o[2]||(o[2]=F=>d.manufacturer=F),options:h.manufacturerOptions,placeholder:"请选择","allow-clear":""},null,8,["value","options"])]),_:1}),t(U,{label:"烧录固件",name:"burnedFirmware",required:""},{default:a(()=>[t(te,{value:d.burnedFirmware,"onUpdate:value":o[3]||(o[3]=F=>d.burnedFirmware=F),placeholder:"请输入"},null,8,["value"])]),_:1}),n("div",Ue,[t(b,{onClick:$},{default:a(()=>o[4]||(o[4]=[u("取消")])),_:1,__:[4]}),t(b,{type:"primary",onClick:z},{default:a(()=>o[5]||(o[5]=[u("下一步")])),_:1,__:[5]})])]),_:1},8,["model"])],64)):p.value===1?(C(),B(X,{key:1},[t(D,{current:1,size:"small",style:{"margin-bottom":"24px"}},{default:a(()=>[t(S,{title:"设备录入"}),t(S,{title:"文件导入"})]),_:1}),n("div",Ne,[t(ae,{"file-list":_.value,"before-upload":P,"custom-request":Q,"show-upload-list":!1},{default:a(()=>[n("div",Ee,[t(I(Be),{style:{"font-size":"48px",color:"#1677ff","margin-bottom":"8px"}})]),o[6]||(o[6]=n("div",{class:"upload-text"},"点击或拖拽文件到此区域上传",-1)),o[7]||(o[7]=n("div",{class:"upload-hint"},"请上传设备导入文件，支持格式：xls、xlsx。",-1))]),_:1,__:[6,7]},8,["file-list"]),w.value?(C(),B("div",Re,[t(N,{percent:g.value,"show-info":!0,style:{width:"90%",margin:"0 auto"}},null,8,["percent"]),n("div",qe,[n("span",null,[t(H,{style:{color:"#52c41a","margin-right":"4px"}}),u(se(w.value),1)]),n("span",null,se(g.value)+"%",1)])])):pe("",!0),n("div",ze,[t(b,{onClick:A},{default:a(()=>o[8]||(o[8]=[u("上一步")])),_:1,__:[8]}),t(b,{type:"primary",disabled:!w.value||g.value<100,onClick:L},{default:a(()=>o[9]||(o[9]=[u("确定")])),_:1,__:[9]},8,["disabled"])])])],64)):(C(),B("div",je,[y.value==="success"?(C(),B(X,{key:0},[n("div",Pe,[t(I(xe))]),o[10]||(o[10]=n("div",{class:"result-title"},"导入成功",-1)),o[11]||(o[11]=n("div",{class:"result-desc"},"已成功导入XX条设备信息数据",-1))],64)):y.value==="duplicate"?(C(),B(X,{key:1},[n("div",Ze,[t(I(Me))]),o[13]||(o[13]=n("div",{class:"result-title"},"导入数据重复",-1)),o[14]||(o[14]=n("div",{class:"result-desc"},"发现XX条数据重复，设备ID不可重复，如继续导入，等重复数据跳过。请确认，下载重复文件。",-1)),t(b,{type:"link",onClick:Y},{default:a(()=>o[12]||(o[12]=[u("下载重复文件")])),_:1,__:[12]})],64)):(C(),B(X,{key:2},[n("div",Ge,[t(I(Ie))]),o[16]||(o[16]=n("div",{class:"result-title"},"导入失败",-1)),o[17]||(o[17]=n("div",{class:"result-desc"},"导入失败，部分数据格式或数据类型不正确，部分必填字段未填写，且部分数据重复。请下载异常文件。",-1)),t(b,{type:"link",onClick:ee},{default:a(()=>o[15]||(o[15]=[u("下载异常文件")])),_:1,__:[15]})],64)),n("div",Xe,[t(b,{onClick:$},{default:a(()=>o[18]||(o[18]=[u("取消")])),_:1,__:[18]}),t(b,{type:"primary",onClick:j},{default:a(()=>o[19]||(o[19]=[u("确定")])),_:1,__:[19]})])]))]),_:1},8,["visible","title"])}}}),Je=de(Le,[["__scopeId","data-v-c9fae0e6"]]),He={style:{display:"flex","justify-content":"center",gap:"16px","margin-top":"24px"}},We=re({__name:"OtaConfigModal",props:{visible:Boolean,deviceModelOptions:Array,latestFirmwareOptions:Array,deviceModelValue:[String,Number,Object],latestFirmwareValue:[String,Number,Object]},emits:["update:visible","ok","update:deviceModelValue","update:latestFirmwareValue"],setup(h,{emit:R}){const v=h,m=R,c=s(v.deviceModelValue),p=s(v.latestFirmwareValue);E(()=>v.deviceModelValue,f=>{c.value=f}),E(()=>v.latestFirmwareValue,f=>{p.value=f}),E(c,f=>{m("update:deviceModelValue",f)}),E(p,f=>{m("update:latestFirmwareValue",f)});function O(){m("update:visible",!1)}function d(){m("ok",{deviceModelValue:c.value,latestFirmwareValue:p.value})}return(f,_)=>{const w=i("a-select"),g=i("a-form-item"),y=i("a-button"),q=i("a-form"),z=i("a-modal");return C(),K(z,{visible:h.visible,title:"OTA配置",footer:null,width:500,onCancel:O,class:"ota-config-modal"},{default:a(()=>[t(q,{layout:"vertical"},{default:a(()=>[t(g,{label:"设备型号",required:""},{default:a(()=>[t(w,{options:h.deviceModelOptions,value:c.value,"onUpdate:value":_[0]||(_[0]=A=>c.value=A),placeholder:"请选择",style:{width:"100%"}},null,8,["options","value"])]),_:1}),t(g,{label:"最新固件",required:""},{default:a(()=>[t(w,{options:h.latestFirmwareOptions,value:p.value,"onUpdate:value":_[1]||(_[1]=A=>p.value=A),placeholder:"请选择",style:{width:"100%"}},null,8,["options","value"])]),_:1}),n("div",He,[t(y,{onClick:O},{default:a(()=>_[2]||(_[2]=[u("取消")])),_:1,__:[2]}),t(y,{type:"primary",onClick:d},{default:a(()=>_[3]||(_[3]=[u("确定")])),_:1,__:[3]})])]),_:1})]),_:1},8,["visible"])}}}),Ke=de(We,[["__scopeId","data-v-8e4e7a8c"]]),Qe={class:"top-controls-wrapper"},Ye={class:"left-aligned-section"},et={class:"select-container device-model-select",style:{"margin-left":"10px"}},tt={class:"select-container manufacturer-select",style:{"margin-left":"10px"}},lt={class:"right-aligned-icons"},at={class:"column-setting-panel",style:{"max-height":"300px","overflow-y":"auto"}},ot={class:"setting-section"},nt={class:"section-header",style:{display:"flex","justify-content":"space-between"}},it={class:"column-checkbox-item",style:{padding:"4px 0"}},st={class:"table-container"},rt=["onClick"],dt=re({__name:"OTA",setup(h){const R=M(()=>({...ce,Pagination:{...ce.Pagination,page:""}})),v=[{key:"rowIndex",title:"序号",dataIndex:"rowIndex",width:60,fixed:"left",customRender:({index:l})=>(S.value-1)*D.value+l+1},{key:"deviceId",title:"设备ID",dataIndex:"deviceId",width:180},{key:"bindAccount",title:"绑定子账户",dataIndex:"bindAccount",width:120},{key:"deviceModel",title:"设备型号",dataIndex:"deviceModel",width:100},{key:"productionBatch",title:"生产批次",dataIndex:"productionBatch",width:120},{key:"manufacturer",title:"生产厂家",dataIndex:"manufacturer",width:180},{key:"initFirmware",title:"初始固件",dataIndex:"initFirmware",width:120},{key:"latestFirmware",title:"最新固件",dataIndex:"latestFirmware",width:120},{key:"currentFirmware",title:"当前固件版本",dataIndex:"currentFirmware",width:120},{key:"sn",title:"SN码",dataIndex:"sn",width:180},{key:"efuseId",title:"eFuse ID",dataIndex:"efuseId",width:180},{key:"mac",title:"MAC地址",dataIndex:"mac",width:160},{key:"tempName",title:"蓝牙名称",dataIndex:"tempName",width:160},{key:"imei",title:"IMEI",dataIndex:"imei",width:160},{key:"sim",title:"4G卡号",dataIndex:"sim",width:160},{key:"cpu",title:"CPU序列",dataIndex:"cpu",width:120},{key:"creator",title:"创建人",dataIndex:"creator",width:80},{key:"createTime",title:"创建时间",dataIndex:"createTime",width:160,sorter:(l,e)=>l.createTime.localeCompare(e.createTime),sortDirections:["ascend","descend"]},{key:"updateTime",title:"更新时间",dataIndex:"updateTime",width:160,sorter:(l,e)=>l.updateTime.localeCompare(e.updateTime),sortDirections:["ascend","descend"]},{key:"operation_24",title:"操作",dataIndex:"operation_24",width:120,fixed:"right"}],m=s(v.map(l=>l.key)),c=s(v.map(l=>l.key)),p=M(()=>c.value.map(e=>v.find(k=>k.key===e)).filter(e=>!!e&&m.value.includes(e.key)).map(e=>({title:e.title,dataIndex:e.dataIndex,key:e.key,width:e.width,fixed:e.fixed,sorter:e.sorter,sortDirections:e.sortDirections,sortOrder:d.value&&e.key===d.value.columnKey?d.value.order:void 0,defaultSortOrder:e.defaultSortOrder,customRender:e.customRender?e.customRender:({text:V})=>V==null||V===""?"-":V,className:e.className})));let O=[];const d=s();Oe(async()=>{O=[...G],console.log("Raw Data:",O)});const f=s({value:"all",label:"全部"}),_=s({value:"all",label:"全部"}),w=M(()=>{const l=new Set;return G.forEach(e=>{e.deviceModel&&l.add(e.deviceModel)}),Array.from(l).map(e=>({label:e,value:e}))}),g=l=>{l&&l.value?console.log("Selected Device Model:",l.label):console.log("Device Model cleared")},y=M(()=>{const l=new Set;return G.forEach(e=>{e.manufacturer&&l.add(e.manufacturer)}),Array.from(l).map(e=>({label:e,value:e}))}),q=l=>{l&&l.value?console.log("Selected Manufacturer:",l.label):console.log("Manufacturer cleared")},z=M(()=>{const l=new Set;return G.forEach(e=>{e.productionBatch&&l.add(e.productionBatch)}),Array.from(l).map(e=>({label:e,value:e}))}),A=M(()=>{const l=new Set;return G.forEach(e=>{e.latestFirmware&&l.add(e.latestFirmware)}),Array.from(l).map(e=>({label:e,value:e}))}),$=s(""),j=M(()=>{let l=O;return $.value&&(l=l.filter(e=>Object.values(e).some(k=>String(k).toLowerCase().includes($.value.toLowerCase())))),l}),P=s(!1),Q=()=>{P.value=!0,setTimeout(()=>{P.value=!1},1e3)},L=s("middle"),Y=l=>{(l.key==="large"||l.key==="middle"||l.key==="small")&&(L.value=l.key)},ee=()=>{console.log("Settings icon clicked")},J=()=>{m.value=v.map(l=>l.key),c.value=v.map(l=>l.key)},x=(l,e)=>{e?m.value.push(l):m.value=m.value.filter(k=>k!==l)},o=l=>{const{oldIndex:e,newIndex:k}=l,V=c.value.splice(e,1)[0];c.value.splice(k,0,V)},S=s(1),D=s(10),Z=M(()=>j.value.length),U=M(()=>({total:Z.value,current:S.value,pageSize:D.value,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["10","20","30","40","50","100"],showTotal:l=>`共 ${l} 条`,position:["bottomRight"]})),te=(l,e,k)=>{console.log("Table changed:",l,e,k),S.value=l.current,D.value=l.pageSize,d.value=k},b=s(!1),le=()=>{b.value=!0},ae=l=>{console.log("Device import finished with values:",l),b.value=!1},N=s(!1),H=s(),W=s(),F=()=>{console.log("OTA Config OK"),N.value=!1},G=Array.from({length:100},(l,e)=>({key:e+1,accountId:`jkhg824&3*g${e+1}`,phoneNumber:`183****795${e+3}`,deviceModel:`HWSZ00${e+1}`,deviceId:`0075A1B2SZTD...XJ${e}`,productId:`hjhtwn832nj${e+1}`,ipRole:`王龙${e+1}`,productModel:`HWSZ00100${e+1}`,currentMemberType:e%3===0?"VIP":e%2===0?"普通会员":"SVIP",memberPayment:e%2===0?"自动续费":"赠送",memberActivationTime:"2025-06-01 10:00:00",memberExpirationTime:"2026-06-01 10:00:00",fourGCardNumber:`147762943013${e+1}`,fourGPlan:e%2===0?"500M/月":"1G/月",remainingDataThisMonth:`${e*10}M`,fourGPayment:e%2===0?"自动续费":"赠送",fourGActivationTime:"2025-06-01 10:00:00",fourGExpirationTime:"2026-06-01 10:00:00",serviceAnnualFeeBalance:26.35,asrAnnualUsage:"384,3848 tokens",llmAnnualUsage:"384,3848 tokens",ttsAnnualUsage:"213.55 h",voiceCloneAnnualUsage:"213.55 h",registrationTime:"2025-06-01 10:00:00",bindAccount:`183****795${e+3}`,productionBatch:"2025-06-30",manufacturer:"深圳沃能威科技有限公司",initFirmware:`Z00${e+1} V 1.0.1`,latestFirmware:`Z00${e+1} V 2.0.1`,currentFirmware:`Z00${e+1} V 1.3.0`,sn:`SZTD...XJ${e}`,efuseId:`ESP32-0075A1B${e+2}`,mac:`DC:54:75:62:66:7${e+2}`,tempName:`Zibbi 00${e+1} 250619XJ${e}`,imei:`3538010036017${e+4}`,sim:`147762943013${e+1}`,cpu:`0x1FFFF7E${e+8}`,creator:"33",createTime:"2025-7-13 19:25:11",updateTime:"2025-7-13 19:25:11"}));return(l,e)=>{const k=i("a-select-option"),V=i("a-select"),ue=i("a-tooltip"),me=i("a-input"),oe=i("a-button"),ne=i("a-menu-item"),ve=i("a-menu"),fe=i("a-dropdown"),_e=i("a-checkbox"),ye=i("a-popover"),ke=i("a-divider"),we=i("a-popconfirm"),ge=i("a-space"),be=i("a-table"),Ce=i("a-config-provider");return C(),K(Ce,{locale:R.value,theme:{algorithm:I(Se).defaultAlgorithm}},{default:a(()=>[e[22]||(e[22]=n("div",{class:"title-container"},[n("h2",null,"设备OTA")],-1)),n("div",Qe,[n("div",Ye,[n("div",et,[e[11]||(e[11]=n("span",{class:"select-always-placeholder"},"设备型号:",-1)),t(ue,{title:f.value.label},{default:a(()=>[t(V,{value:f.value,"onUpdate:value":e[0]||(e[0]=r=>f.value=r),style:{width:"120px"},options:w.value,onChange:g,allowClear:!0,"label-in-value":""},{default:a(()=>[t(k,{value:"all"},{default:a(()=>e[10]||(e[10]=[u("全部")])),_:1,__:[10]})]),_:1},8,["value","options"])]),_:1},8,["title"])]),n("div",tt,[e[13]||(e[13]=n("span",{class:"select-always-placeholder"},"生产厂家:",-1)),t(ue,{title:_.value.label},{default:a(()=>[t(V,{value:_.value,"onUpdate:value":e[1]||(e[1]=r=>_.value=r),style:{width:"120px"},options:y.value,onChange:q,allowClear:!0,"label-in-value":""},{default:a(()=>[t(k,{value:"all"},{default:a(()=>e[12]||(e[12]=[u("全部")])),_:1,__:[12]})]),_:1},8,["value","options"])]),_:1},8,["title"])])]),n("div",lt,[t(me,{value:$.value,"onUpdate:value":e[2]||(e[2]=r=>$.value=r),placeholder:"输入关键字搜索",style:{width:"200px"}},{prefix:a(()=>[t(I(Fe))]),_:1},8,["value"]),t(oe,{type:"primary",onClick:le},{default:a(()=>e[14]||(e[14]=[u("设备导入")])),_:1,__:[14]}),t(oe,{type:"primary",onClick:e[3]||(e[3]=r=>N.value=!0)},{default:a(()=>e[15]||(e[15]=[u("OTA配置")])),_:1,__:[15]}),t(I(Ve),{onClick:Q}),t(fe,null,{overlay:a(()=>[t(ve,{onClick:Y},{default:a(()=>[t(ne,{key:"large"},{default:a(()=>e[16]||(e[16]=[u("宽松")])),_:1,__:[16]}),t(ne,{key:"middle"},{default:a(()=>e[17]||(e[17]=[u("中等")])),_:1,__:[17]}),t(ne,{key:"small"},{default:a(()=>e[18]||(e[18]=[u("紧凑")])),_:1,__:[18]})]),_:1})]),default:a(()=>[t(I(Ae),{onClick:e[4]||(e[4]=$e(()=>{},["prevent"]))})]),_:1}),t(ye,{trigger:"click",placement:"bottomRight"},{content:a(()=>[n("div",at,[n("div",ot,[n("div",nt,[e[20]||(e[20]=n("span",null,"列展示",-1)),t(oe,{type:"link",onClick:J},{default:a(()=>e[19]||(e[19]=[u("重置")])),_:1,__:[19]})]),t(I(Te),{modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=r=>c.value=r),"item-key":"key",onEnd:o,class:"column-checkbox-group"},{item:a(({element:r})=>[n("div",it,[t(_e,{checked:m.value.includes(r),onChange:T=>x(r,T.target.checked)},{default:a(()=>{var T;return[u(se((T=v.find(ie=>ie.key===r))==null?void 0:T.title),1)]}),_:2},1032,["checked","onChange"])])]),_:1},8,["modelValue"])])])]),default:a(()=>[t(I(De),{onClick:ee})]),_:1})])]),n("div",st,[t(be,{columns:p.value,"data-source":j.value,pagination:j.value.length===0?!1:U.value,loading:P.value,size:L.value,scroll:{x:3e3},onChange:te,showSorterTooltip:!1},{bodyCell:a(({column:r,record:T})=>[r.key==="operation_24"?(C(),K(ge,{key:0,class:"action-cell",direction:"horizontal"},{default:a(()=>[n("a",{class:"edit-link",onClick:ie=>l.$emit("edit-record",T)},"编辑",8,rt),t(ke,{type:"vertical"}),t(we,{title:"确定要删除该信息吗?",onConfirm:ie=>l.$emit("delete-record",T)},{default:a(()=>e[21]||(e[21]=[n("a",{class:"danger-link"},"删除",-1)])),_:2,__:[21]},1032,["onConfirm"])]),_:2},1024)):pe("",!0)]),_:1},8,["columns","data-source","pagination","loading","size"])]),t(Je,{visible:b.value,"onUpdate:visible":e[6]||(e[6]=r=>b.value=r),deviceModelOptions:w.value,manufacturerOptions:y.value,productionBatchOptions:z.value,onFinish:ae},null,8,["visible","deviceModelOptions","manufacturerOptions","productionBatchOptions"]),t(Ke,{visible:N.value,"onUpdate:visible":e[7]||(e[7]=r=>N.value=r),deviceModelOptions:w.value,latestFirmwareOptions:A.value,deviceModelValue:H.value,"onUpdate:deviceModelValue":e[8]||(e[8]=r=>H.value=r),latestFirmwareValue:W.value,"onUpdate:latestFirmwareValue":e[9]||(e[9]=r=>W.value=r),onOk:F},null,8,["visible","deviceModelOptions","latestFirmwareOptions","deviceModelValue","latestFirmwareValue"])]),_:1,__:[22]},8,["locale","theme"])}}}),vt=de(dt,[["__scopeId","data-v-0c4f2661"]]);export{vt as default};
